# Story 3.6: Utility Integration Mapping - Part 3

**Created:** 2025-10-29  
**Authors:** Sarah (@po), Winston (@architect)  
**Purpose:** Define integration strategy for 13 utilities in Story 3.6  
**Pattern:** Follows Story 3.4/3.5 successful approach

---

## Scope Correction

**Original Claim:** 21 utilities  
**Validation Results:**
- 2 DUPLICATES (already in Story 3.5): yaml-validator, security-checker
- 6 NON-EXISTENT (files not found): status-mapper, story-manager, story-update-hook, tool-helper-executor, tool-resolver, tool-validation-helper
- 1 DEPRECATED (decision needed): backup-manager

**CORRECTED SCOPE:** 13 utilities (excluding deprecated backup-manager)

---

## Utility Categorization

### Category 1: Testing & Quality Assurance (5 utilities)

|| # | Utility | Target Agent | Integration Pattern | Priority |
|---|---------|--------------|---------------------|----------|
|| 1 | **util-test-generator** | agent-qa | Task Execution | HIGH |
|| 2 | **util-test-quality-assessment** | agent-qa | Agent Helper | HIGH |
|| 3 | **util-test-template-system** | agent-qa | Framework | MEDIUM |
|| 4 | **util-test-updater** | agent-qa | Task Execution | MEDIUM |
|| 5 | **util-visual-impact-generator** | agent-qa | Agent Helper | LOW |

**Integration Approach:**
- Primary user: agent-qa (testing and quality assurance)
- test-generator creates comprehensive test suites
- test-quality-assessment evaluates test coverage and effectiveness
- test-template-system provides test template framework
- test-updater maintains and updates existing tests
- visual-impact-generator creates visual regression tests

**Notes:**
- test-generator: Generates unit, integration, and E2E tests
- test-quality-assessment: Analyzes test quality metrics
- test-template-system: Framework-level test template engine
- test-updater: Automated test maintenance
- visual-impact-generator: Visual regression testing support

---

### Category 2: Template Management (2 utilities)

|| # | Utility | Target Agent | Integration Pattern | Priority |
|---|---------|--------------|---------------------|----------|
|| 6 | **util-template-engine** | agent-po | Framework | HIGH |
|| 7 | **util-template-validator** | agent-po | Agent Helper | HIGH |

**Integration Approach:**
- Primary user: agent-po (document generation and template management)
- template-engine provides core template rendering capabilities
- template-validator ensures template correctness and completeness
- Both critical for story/PRD/epic generation workflows

**Notes:**
- template-engine: Core template rendering with variable substitution
- template-validator: Validates template syntax and required fields
- Used in create-story, create-epic, create-doc tasks

---

### Category 3: Analytics & Tracking (3 utilities)

|| # | Utility | Target Agent | Integration Pattern | Priority |
|---|---------|--------------|---------------------|----------|
|| 8 | **util-usage-analytics** | framework | Framework | MEDIUM |
|| 9 | **util-usage-tracker** | framework | Framework | MEDIUM |
|| 10 | **util-version-tracker** | agent-github-devops | Agent Helper | MEDIUM |

**Integration Approach:**
- usage-analytics and usage-tracker are framework-level utilities
- Provide system-wide analytics and usage tracking
- version-tracker supports github-devops for version management
- Enable data-driven decision making

**Notes:**
- usage-analytics: Analyzes usage patterns and trends
- usage-tracker: Tracks feature and command usage
- version-tracker: Manages version tracking and history

---

### Category 4: Transaction & Validation (2 utilities)

|| # | Utility | Target Agent | Integration Pattern | Priority |
|---|---------|--------------|---------------------|----------|
|| 11 | **util-transaction-manager** | framework | Framework | MEDIUM |
|| 12 | **util-validate-filenames** | agent-dev | Agent Helper | LOW |

**Integration Approach:**
- transaction-manager provides atomic operations for critical workflows
- validate-filenames ensures consistent naming conventions
- Both support data integrity and code quality

**Notes:**
- transaction-manager: ACID transaction support for critical operations
- validate-filenames: Validates file naming conventions across project

---

### Category 5: Deprecated (1 utility - EXCLUDED)

|| # | Utility | Status | Decision | Rationale |
|---|---------|--------|----------|-----------|
|| 13 | **util-backup-manager** | DEPRECATED | EXCLUDE | Marked for removal in gap-backlog.csv |

**Decision:** DO NOT INTEGRATE
- Gap entry states: "Deprecated entity can be safely removed"
- Modern backup strategies use git and infrastructure tools
- Legacy utility no longer needed

---

## Integration Pattern Summary

### Pattern 1: Agent Helper (5 utilities)
- test-quality-assessment → agent-qa
- visual-impact-generator → agent-qa
- template-validator → agent-po
- version-tracker → agent-github-devops
- validate-filenames → agent-dev

**Implementation:**
- Add to agent `dependencies.utils` array
- Include inline comments explaining purpose
- Files: agent MD/YAML, core-config, README

---

### Pattern 2: Task Execution (2 utilities)
- test-generator → agent-qa (create task: generate-tests)
- test-updater → agent-qa (create task: update-tests)

**Implementation:**
- Create or update task file
- Add utility to task execution dependencies
- Add task to agent executes list
- Files: task MD, agent MD/YAML, core-config, README

---

### Pattern 3: Framework (4 utilities)
- template-engine → framework (core template rendering)
- test-template-system → framework (test template framework)
- usage-analytics → framework (system analytics)
- usage-tracker → framework (usage tracking)
- transaction-manager → framework (transaction support)

**Implementation:**
- Register in core-config under framework
- Document as framework utility
- Files: core-config, README, framework docs

---

## Agent Assignment Matrix

| Agent | Utilities | Count | Integration Effort |
|-------|-----------|-------|-------------------|
| **agent-qa** | test-generator, test-quality-assessment, test-template-system, test-updater, visual-impact-generator | 5 | 1.5h |
| **agent-po** | template-engine, template-validator | 2 | 45min |
| **agent-github-devops** | version-tracker | 1 | 15min |
| **agent-dev** | validate-filenames | 1 | 15min |
| **framework** | usage-analytics, usage-tracker, transaction-manager | 3 | 45min |

**Total Agents:** 4 + framework  
**Total Utilities:** 13 (excluding deprecated)

---

## Task Creation Needs

### NEW Tasks to Create (2)
1. **generate-tests.md** - For util-test-generator
   - Purpose: Generate comprehensive test suites
   - Command: `*generate-tests <target> <type>`
   - Types: unit, integration, e2e

2. **update-tests.md** - For util-test-updater
   - Purpose: Update existing tests to match code changes
   - Command: `*update-tests <test-file> [options]`

### EXISTING Tasks to UPDATE (1)
1. **create-doc.md** - Reference template-engine and template-validator
   - Add execution dependencies section
   - Utils: template-engine, template-validator

---

## Priority Implementation Order

### Phase 1: HIGH Priority (2.5h)
**Testing & Quality (agent-qa: 5 utilities)**
- test-generator (Task Execution) - 30min
- test-quality-assessment (Agent Helper) - 20min
- test-template-system (Framework) - 20min
- test-updater (Task Execution) - 30min
- visual-impact-generator (Agent Helper) - 20min

**Template Management (agent-po: 2 utilities)**
- template-engine (Framework) - 20min
- template-validator (Agent Helper) - 20min

### Phase 2: MEDIUM Priority (1h)
**Analytics & Tracking**
- usage-analytics (Framework) - 15min
- usage-tracker (Framework) - 15min
- version-tracker (Agent Helper, github-devops) - 15min

**Transaction & Validation**
- transaction-manager (Framework) - 15min

### Phase 3: LOW Priority (15min)
**Validation**
- validate-filenames (Agent Helper, dev) - 15min

---

## Files to Modify

### Agents (4 files)
1. `aios-fullstack/aios-core/agents/qa.md` - Add 5 utilities
2. `aios-fullstack/aios-core/agents/po.md` - Add 2 utilities
3. `.aios-core/agents/github-devops.md` - Add 1 utility
4. `aios-fullstack/aios-core/agents/dev.md` - Add 1 utility

### Tasks (3 files)
1. `aios-fullstack/aios-core/tasks/generate-tests.md` - CREATE
2. `aios-fullstack/aios-core/tasks/update-tests.md` - CREATE
3. `aios-fullstack/aios-core/tasks/create-doc.md` - UPDATE

### Configuration (2 files)
1. `aios-fullstack/aios-core/core-config.yaml` - Register 13 utilities
2. `aios-fullstack/aios-core/core-config.yaml.backup-3.6` - Backup

### Documentation (1 file)
1. `aios-fullstack/aios-core/utils/README.md` - Document 13 utilities

### Testing (1 file)
1. `aios-fullstack/tests/integration/test-utilities-part-3.js` - Create test suite

---

## Time Estimates by Category

| Category | Utilities | Agents | Tasks | Time |
|----------|-----------|--------|-------|------|
| Testing & Quality | 5 | 1 | 2 new | 2h |
| Template Management | 2 | 1 | 1 update | 45min |
| Analytics & Tracking | 3 | 1 | 0 | 45min |
| Transaction & Validation | 2 | 1 | 0 | 30min |
| Config & Docs | - | - | - | 30min |
| Testing & Validation | - | - | - | 30min |
| **TOTAL** | **13** | **4** | **3** | **~5h** |

**Note:** Estimate reduced from original 8h due to:
- Corrected scope (21 → 13 utilities)
- Pattern efficiency (3rd iteration)
- No large utilities (all straightforward)

---

## Integration Patterns Reused from 3.4/3.5

**Pattern Consistency:** 98%

Story 3.6 follows the exact same workflow as Stories 3.4 and 3.5:
1. Categorize utilities by function
2. Map to target agents
3. Define integration patterns
4. Create task files as needed
5. Update agent dependencies
6. Register in core-config
7. Document in README
8. Test and validate

**Expected Results Based on Pattern:**
- Operational rate: 95-100% (based on 3.4: 87%, 3.5: 95%)
- QA score: 94-96/100 (based on 3.4: 92/100, 3.5: 94/100)
- Zero gaps: 100% (based on 3.4 and 3.5 achieving 0 gaps)

---

## Risk Assessment

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| Testing utilities complex | LOW | MEDIUM | agent-qa already exists with testing expertise |
| Template engine integration | MEDIUM | HIGH | Critical for PO workflows, thorough testing needed |
| Framework utilities untested | LOW | LOW | Framework-level, no direct agent interaction |
| Validation scope changes | VERY LOW | LOW | Scope validated and corrected |

**Overall Risk:** LOW (following proven pattern with corrected scope)

---

## Success Criteria

✅ All 13 utilities categorized and mapped  
✅ Integration patterns defined for each utility  
✅ Target agents identified  
✅ Task creation needs documented  
✅ Priority implementation order established  
✅ Time estimates provided  
✅ Files to modify listed  
✅ Pattern reuse from 3.4/3.5 confirmed

---

## Expected Outcome

**After Implementation:**
- 13/13 utilities integrated ✅
- 0 gaps for these utilities ✅
- 95-100% operational rate ✅
- 94-96/100 QA score ✅
- Total utilities: 58/67 (87% of Category 1) ✅

**Cumulative Progress:**
- Story 3.4: 23 utilities (34%)
- Story 3.5: 22 utilities (33%)
- Story 3.6: 13 utilities (19%)
- **Total: 58/67 utilities integrated (87%)**

---

**Created By:** Sarah (@po), Winston (@architect)  
**Date:** 2025-10-29  
**Status:** Ready for Story Refinement  
**Next Step:** Use this mapping to expand Story 3.6 acceptance criteria and tasks


